<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ë…¸ë˜ë°©</title>
<style>
  body {
    font-family: 'Pretendard', sans-serif;
    background-color: #f8f8f8;
    color: #2a2628;
    text-align: center;
    padding: 50px;
    max-width: 700px;
    margin: auto;
  }
  h1 {
    color: #008ae3;
    font-size: 2em;
    margin-bottom: 20px;
  }
  input, select, button {
    font-size: 1em;
    padding: 8px 12px;
    margin: 6px 0;
    border: 2px solid #008ae3;
    border-radius: 6px;
  }
  #startBtn, .actionBtn {
    background-color: #008ae3;
    color: white;
    border: none;
    cursor: pointer;
    margin-top: 10px;
  }
  #startBtn:hover, .actionBtn:hover {
    background-color: #006bb5;
  }
  #prevLyrics, #nextLyrics {
    font-size: 1em;
    color: #a0a7a5;
    margin: 5px 0;
    min-height: 1.5em;
    user-select: none;
    line-height: 1.6em; /* ì¤„ ê°„ê²© í†µì¼ */
  }
  #lyrics {
    font-size: 1.4em;
    margin: 10px 0 30px;
    font-weight: bold;
    color: #2a2628;
    line-height: 1.6em; /* ì¤„ ê°„ê²© í†µì¼ */
    min-height: 2.4em; /* ê°€ì‚¬ ì˜ì—­ ë†’ì´ ì¼ì • */
  }
  input#typing {
    width: 90%;
    padding: 12px;
    border: 2px solid #008ae3;
  }
  #result {
    margin-top: 30px;
    font-size: 1.6em;
    font-weight: bold;
    color: #2a2628;
  }
  #ment {
    font-size: 1.2em;
    margin-top: 10px;
    color: #2a2628;
  }
  #actions {
    margin-top: 20px;
  }
  #shareText {
    margin-top: 10px;
    font-size: 0.9em;
    color: #666;
  }
  #screenshotArea {
    display: inline-block;
    background: #fff;
    padding: 20px;
    border: 2px dashed #008ae3;
    border-radius: 10px;
    margin-top: 20px;
    user-select: none;
  }
  #loading {
    font-size: 1.5em;
    color: #008ae3;
    display: none;
  }
  #prevLyrics, #nextLyrics {
  font-size: 1em;
  color: #a0a7a5;
  margin: 2px 0 5px 0; /* ìœ„ìª½ ê°„ê²© ì¤„ì´ê³ , ì•„ë˜ìª½ ê°„ê²©ë„ ì¤„ì„ */
  min-height: 1.5em;
  user-select: none;
  line-height: 1.4em; /* ì¤„ ê°„ê²© ì‚´ì§ ì¢ê²Œ */
}
#lyrics {
  font-size: 1.4em;
  margin: 10px 0 12px 0; /* ì•„ë˜ìª½ ê°„ê²©ì„ ì¡°ê¸ˆë§Œ ì¤Œ */
  font-weight: bold;
  color: #2a2628;
  line-height: 1.6em;
  min-height: 2.4em;
}

</style>
</head>
<body>

<h1>ğŸ¤ ë…¸ë˜ë°©</h1>

<label for="nicknameInput">ë‹‰ë„¤ì„ ì…ë ¥:</label><br />
<input type="text" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="15" /><br />

<select id="songSelect" aria-label="ë…¸ë˜ ì„ íƒ">
  <option value="0">í˜í¼í†¤ìŠ¤ - ìƒ¤ì¸</option>
  <option value="1">ìœ¤í•˜ - í¬ì¸íŠ¸ ë‹ˆëª¨</option>
  <option value="2">ì •ìš° - ë‚˜ì—ê²Œì„œ ë‹¹ì‹ ì—ê²Œ</option>
  <option value="3">ê¸°í˜„ - Youth</option>
  <option value="4">ì”ë‚˜ë¹„ - ì‘ì •ëª… ì²­-ì¶˜!</option>
  <option value="5">ë‹¬ë‹´ - ì¡¸ì—…</option>
  <option value="6">ë¹¨ë˜(ë®¤ì§€ì»¬) - ìŠ¬í”Œ ë• ë¹¨ë˜ë¥¼ í•´</option>
</select><br />
<button id="startBtn">â–¶ï¸ ì‹œì‘í•˜ê¸°</button>

<div id="prevLyrics"></div>
<div id="lyrics">ë…¸ë˜ë¥¼ ì„ íƒí•˜ê³  ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
<div id="nextLyrics"></div>

<input type="text" id="typing" placeholder="ê°€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off" disabled />

<div id="screenshotArea">
  <p id="result">ì ìˆ˜: --ì </p>
  <p id="ment"></p>
</div>

<p id="loading">ğŸ° ì ìˆ˜ ê³„ì‚° ì¤‘...</p>

<div id="actions">
  <button class="actionBtn" onclick="startGame()">ğŸ” ë‹¤ì‹œ ì‹œì‘</button>
  <button class="actionBtn" onclick="saveScreenshot()">ğŸ“¸ ìŠ¤ìƒ· ì €ì¥</button>
  <button class="actionBtn" onclick="shareScore()">ğŸ“¢ ê³µìœ í•˜ê¸°</button>
  <p id="shareText"></p>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
  const songs = [
    {
      title: "í˜í¼í†¤ìŠ¤ - ìƒ¤ì¸",
      lyrics: [
        "ë•Œë¡œ ë‚´ ì „ë¶€ë¥¼ ê±¸ê³  ì§„ì‹¬ìœ¼ë¡œ ë¶€ë”ªíˆì§€ ì•ŠëŠ”ë‹¤ë©´",
        "ì–´ë””ê°€ ëì¸ì§€ ì•Œ ìˆ˜ëŠ” ì—†ê² ì§€",
        "ë¶€ë„ëŸ¬ì›€ì„ ëš«ê³  ë¬´ë¦¬ ë°–ìœ¼ë¡œ ë‚˜ì„œì§€ ì•ŠëŠ”ë‹¤ë©´",
        "ë” ë„“ì€ ì„¸ìƒì„ ë³¼ ìˆœ ì—†ì„ ê±°ì•¼"
      ]
    },
    {
      title: "ìœ¤í•˜ - í¬ì¸íŠ¸ ë‹ˆëª¨",
      lyrics: [
        "ì„¸ìƒì˜ ê¸°ì¨ì„ ì£„ë‹¤ ëˆ„ë¦° ê²ƒ ê°™ì€ ê¸°ë¶„ì´ì—ˆì§€",
        "í•œì¼ ì— í”¼ì–´ë‚˜ë˜ ë¶ˆì•ˆí•¨ê³¼ ì‹¸ì›Œ ì´ê¸°ë©´ì„œë„",
        "ì–´ë””ê¹Œì§€ ë©€ë¦¬ ë‚ ì•„ì˜¤ë¥´ê³  ì‹¶ì—ˆë˜ ê±¸ê¹Œ",
        "ê·¸ë• ê·¸ê²Œ ì •ë‹µì´ì—ˆì–´"
      ]
    },
    {
      title: "ì •ìš° - ë‚˜ì—ê²Œì„œ ë‹¹ì‹ ì—ê²Œ",
      lyrics: [
        "ë‚˜ëŠ” êµ¬ë¦„ì˜ ê°•ìœ¼ë¡œ ê°€ë…¸ë‹ˆ",
        "ëª»ë‹¤ í•œ ë§ì€ í–‡ì‚´ì— ë„ì›Œì£¼ì„¸ìš”",
        "ë‚¨ì€ ë§ì€ ë°”ëŒì— ì†ì‚­ì´ì„¸ìš”",
        "ë‚˜ë¥¼ í•œ ë²ˆë§Œ ë” ë‹¬ì— ë°ë ¤ë‹¤ì¤˜"
      ]
    },
    {
      title: "ê¸°í˜„ - Youth",
      lyrics: [
        "ë‚œ ê°€ë” ê·¸ë¦¬ìš¸ ê²ƒ ê°™ì•„ ì–´ë¦¬ì„ì—ˆë˜",
        "ê·¸ë˜ì„œ ë” ë‹¬ë¦¬ê³  ë‹¬ë ¸ë˜ ë‚ ë“¤",
        "í‘¸ë¥´ê³  ë˜ í‘¸ë¥´ë˜ ëª¨ìŠµì´",
        "ìƒˆë¹¨ê°›ê²Œ ì¶¤ì¶”ê³  ë›°ë˜ ê°€ìŠ´ë„"
      ]
    },
    {
      title: "ì”ë‚˜ë¹„ - ì‘ì •ëª… ì²­-ì¶˜!",
      lyrics: [
        "ì–´ë¥¸ì´ ëœ ì˜¤ëŠ˜ ë‚´ê²Œ ì„¸ìƒì´ë€ ê³³",
        "ì–´ë¦´ ì  ê·¸ë¦¬ë˜ ê¿ˆì† ì „ìŸí„°êµ¬ë‚˜",
        "ê·¸ ì†ì—ì„œ ë‚˜ëŠ” ë‹¤ì‹œ ì˜ì›…ì´ ë˜ë ¤",
        "ì„ í¬í•œë‹¤ ì‘ì „ëª… ì²­ì¶˜"
      ]
    },
    {
      title: "ë‹¬ë‹´ - ì¡¸ì—…",
      lyrics: [
        "í‘¸ë¥´ë˜ í•˜ëŠ˜ ì•„ë˜ ì•„ì´ë“¤ê³¼",
        "ê¿ˆì„ ê¾¼ ì˜ì ìœ„ì— ì´ˆë¡ ì—°ì„œ",
        "ì´ê³³ì„ ë– ë‚˜ê°€ëŠ” ì‚¬ë‘ì´ì—¬",
        "ì²­ì¶˜ì´ ê·¸ë¦¬ìš°ë©´ ë‚´ê²Œ ì˜¤ë¼"
      ]
    },
    {
      title: "ë¹¨ë˜(ë®¤ì§€ì»¬) - ìŠ¬í”Œ ë• ë¹¨ë˜ë¥¼ í•´",
      lyrics: [
        "ë¹¨ë˜ê°€ ë°”ëŒì— ì œ ëª¸ì„ ë§¡ê¸°ëŠ” ê²ƒì²˜ëŸ¼",
        "ì¸ìƒë„ ë°”ëŒì— ë§¡ê¸°ëŠ” ê±°ì•¼",
        "ì‹œê°„ì´ í˜ëŸ¬í˜ëŸ¬ ë¹¨ë˜ê°€ ë§ˆë¥´ëŠ” ê²ƒì²˜ëŸ¼",
        "ìŠ¬í”ˆ ë„¤ ëˆˆë¬¼ë„ ë§ˆë¥¼ ê±°ì•¼",
        "ì í˜ì„ ë‚´"
      ]
    }
  ];

  const mentMap = [
    { max: 30, text: "ğŸ¤¯ ì†ê°€ë½ êº¾ì˜€ë‚˜ìš”? ë‹¤ì‹œ í•˜ì‹œì£ " },
    { max: 60, text: "ğŸ˜ í‰ë²” ê·¸ ìì²´... ë„ì „ì€ ê³„ì†ëœë‹¤!" },
    { max: 80, text: "âœ¨ ì˜¤! ì œë²•ì¸ë°ìš”?" },
    { max: 95, text: "ğŸ”¥ ë‹¹ì‹  í˜¹ì‹œ íƒ€ìì™•?!" },
    { max: 101, text: "ğŸ‘‘ ì „ì„¤ì´ë‹¤... ì™•ì¤‘ì™•..." }
  ];

  let currentSongIndex = 0;
  let currentLine = 0;

  const prevEl = document.getElementById("prevLyrics");
  const lyricEl = document.getElementById("lyrics");
  const nextEl = document.getElementById("nextLyrics");
  const inputEl = document.getElementById("typing");
  const resultEl = document.getElementById("result");
  const mentEl = document.getElementById("ment");
  const loadingEl = document.getElementById("loading");
  const shareTextEl = document.getElementById("shareText");
  const songSelectEl = document.getElementById("songSelect");
  const startBtn = document.getElementById("startBtn");
  const nicknameInput = document.getElementById("nicknameInput");

  songSelectEl.addEventListener("change", () => {
    currentSongIndex = Number(songSelectEl.value);
    lyricEl.textContent = "ë…¸ë˜ë¥¼ ì„ íƒí•˜ê³  ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”";
    prevEl.textContent = "";
    nextEl.textContent = "";
    inputEl.value = "";
    inputEl.disabled = true;
    resultEl.textContent = "ì ìˆ˜: --ì ";
    mentEl.textContent = "";
    shareTextEl.textContent = "";
    loadingEl.style.display = "none";
  });

  startBtn.addEventListener("click", () => {
    if (nicknameInput.value.trim() === "") {
      alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
      nicknameInput.focus();
      return;
    }
    startGame();
  });

  function updateLyricsPreview() {
    const lyrics = songs[currentSongIndex].lyrics;
    prevEl.textContent = currentLine > 0 ? lyrics[currentLine - 1] : "";
    lyricEl.textContent = lyrics[currentLine];
    nextEl.textContent = currentLine < lyrics.length - 1 ? lyrics[currentLine + 1] : "";
  }

  function startGame() {
    currentLine = 0;
    inputEl.disabled = false;
    inputEl.value = "";
    resultEl.textContent = "ì ìˆ˜: --ì ";
    mentEl.textContent = "";
    shareTextEl.textContent = "";
    loadingEl.style.display = "none";
    updateLyricsPreview();
    inputEl.focus();
  }

  // ì ìˆ˜ ëœë¤ ë¶„í¬ë¥¼ 80 ì´ìƒ í™•ë¥  ë‚®ì¶”ê¸°
  function getRandomScore() {
    const r = Math.random();
    if (r < 0.6) return Math.floor(Math.random() * 60); // 0~59 (60%)
    else if (r < 0.9) return Math.floor(60 + Math.random() * 20); // 60~79 (30%)
    else return Math.floor(80 + Math.random() * 21); // 80~100 (10%)
  }

  function getMent(score) {
    return mentMap.find(m => score <= m.max).text;
  }

  inputEl.addEventListener("input", () => {
    const input = inputEl.value;
    const lyrics = songs[currentSongIndex].lyrics;
    const target = lyrics[currentLine];
    if (input === target) {
      currentLine++;
      if (currentLine < lyrics.length) {
        updateLyricsPreview();
        inputEl.value = "";
      } else {
        inputEl.disabled = true;
        showRollingScore();
      }
    }
  });

  function showRollingScore() {
    loadingEl.style.display = "block";
    resultEl.textContent = "ì ìˆ˜: ğŸ²ğŸ²ğŸ²";
    mentEl.textContent = "";

    let count = 0;
    const roll = setInterval(() => {
      resultEl.textContent = `ì ìˆ˜: ${Math.floor(Math.random() * 101)}ì `;
      count++;
      if (count >= 10) {
        clearInterval(roll);
        const score = getRandomScore();
        const nickname = nicknameInput.value.trim();
        resultEl.textContent = `${nickname}ë‹˜ì˜ ì ìˆ˜ëŠ”... ${score}ì !`;
        mentEl.textContent = getMent(score);
        loadingEl.style.display = "none";
      }
    }, 100);
  }

  function saveScreenshot() {
    html2canvas(document.getElementById("screenshotArea")).then(canvas => {
      const link = document.createElement("a");
      link.download = "shine_score.png";
      link.href = canvas.toDataURL();
      link.click();
    });
  }

  function shareScore() {
    const nickname = nicknameInput.value.trim();
    const text = `${nickname}ë‹˜ì˜ ì ìˆ˜ëŠ”... ${resultEl.textContent.split('...')[1]}\n${mentEl.textContent}\n(ë…¸ë˜ë°©)`;
    navigator.clipboard.writeText(text).then(() => {
      shareTextEl.textContent = "ğŸ“‹ ì ìˆ˜ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆì–´ìš”! ì¹œêµ¬ì—ê²Œ ë¶™ì—¬ë„£ê¸° Ctrl+V";
    });
  }

  songSelectEl.value = "0";
  inputEl.disabled = true;
</script>
</body>
</html>
